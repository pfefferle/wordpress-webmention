(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var n=e.n(t);const o=window.wp.data,r=window.wp.i18n,i=[{value:"",label:(0,r.__)("None","webmention")},{value:"u-in-reply-to",label:(0,r.__)("Reply","webmention")},{value:"u-like-of",label:(0,r.__)("Like","webmention")},{value:"u-repost-of",label:(0,r.__)("Repost","webmention")},{value:"u-bookmark-of",label:(0,r.__)("Bookmark","webmention")},{value:"u-tag-of",label:(0,r.__)("Tag","webmention")}],c=i.map(e=>e.value).filter(e=>e);function l(){return(0,o.select)("core/block-editor").getSelectedBlock()}function a(e){if(!e)return"";for(const t of c)if(e.includes(t))return t;return""}function s(){const e=document.querySelector(".block-editor-link-control__search-input input");if(e&&e.value)return e.value;const t=document.querySelector(".block-editor-link-control__search-item-info");return t?t.textContent?.trim():null}function u(){const e=document.querySelector(".block-editor-link-control__settings");if(!e)return;if(e.querySelector(".webmention-reaction-setting"))return;const t=function(){const e=function(e){const t=l();if(!t)return"";const{attributes:n}=t;if(n.content){let t=n.content;if("object"==typeof t&&t.toHTMLString&&(t=t.toHTMLString()),"string"!=typeof t)return"";const o=(new DOMParser).parseFromString(`<div>${t}</div>`,"text/html").querySelectorAll("a");for(const t of o){const n=t.getAttribute("href");if(!e||n===e){const e=a(t.getAttribute("class"));if(e)return e}}}return""}(s()),t=document.createElement("div");t.className="block-editor-link-control__setting webmention-reaction-setting";const n=document.createElement("span");n.className="webmention-reaction-setting__label",n.textContent=(0,r.__)("Reaction","webmention"),t.appendChild(n);const u=document.createElement("select");return u.className="webmention-reaction-setting__select components-select-control__input",i.forEach(t=>{const n=document.createElement("option");n.value=t.value,n.textContent=t.label,n.selected=t.value===e,u.appendChild(n)}),u.addEventListener("change",e=>{!function(e){const t=l();if(!t)return;const{clientId:n,attributes:r}=t,i=s();if(!r.content)return;let a=r.content;if("object"==typeof a&&a.toHTMLString&&(a=a.toHTMLString()),"string"!=typeof a)return;const u=(new DOMParser).parseFromString(`<div>${a}</div>`,"text/html").body.firstChild,d=u.querySelectorAll("a");let b=!1;d.forEach(t=>{const n=t.getAttribute("href");i&&n!==i||(c.forEach(e=>{t.classList.remove(e)}),e&&t.classList.add(e),0===t.classList.length&&t.removeAttribute("class"),b=!0)}),b&&(0,o.dispatch)("core/block-editor").updateBlockAttributes(n,{content:u.innerHTML})}(e.target.value)}),t.appendChild(u),t}();e.appendChild(t)}n()(()=>{new MutationObserver(()=>{setTimeout(u,50)}).observe(document.body,{childList:!0,subtree:!0})})})();