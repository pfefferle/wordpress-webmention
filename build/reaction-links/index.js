(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var n=e.n(t);const o=window.wp.data,r=window.wp.i18n,i=[{value:"",label:(0,r.__)("None","webmention")},{value:"u-in-reply-to",label:(0,r.__)("Reply","webmention")},{value:"u-like-of",label:(0,r.__)("Like","webmention")},{value:"u-repost-of",label:(0,r.__)("Repost","webmention")},{value:"u-bookmark-of",label:(0,r.__)("Bookmark","webmention")},{value:"u-tag-of",label:(0,r.__)("Tag","webmention")}],c=i.map(e=>e.value).filter(e=>e);function l(){return(0,o.select)("core/block-editor").getSelectedBlock()}function a(e){if(!e)return"";const t=e.trim().split(/\s+/);for(const e of c)if(t.includes(e))return e;return""}function s(){const e=document.querySelector(".block-editor-link-control__search-input input");if(e&&e.value)return e.value;const t=document.querySelector(".block-editor-link-control__search-item-info a");if(t){const e=t.getAttribute("href");if(e)return e.trim()}return null}function u(){const e=document.querySelector(".block-editor-link-control__settings");if(!e)return;const t=s(),n=function(e){const t=l();if(!t)return"";const{attributes:n}=t;if(n.content){let t=n.content;if("object"==typeof t&&t.toHTMLString&&(t=t.toHTMLString()),"string"!=typeof t)return"";const o=(new DOMParser).parseFromString(`<div>${t}</div>`,"text/html").querySelectorAll("a");for(const t of o){const n=t.getAttribute("href");if(!e||n===e){const e=a(t.getAttribute("class"));if(e)return e}}}return""}(t),u=e.querySelector(".webmention-reaction-setting");if(u){if(u.dataset.url===(t||"")){const e=u.querySelector("select");return void(e&&e.value!==n&&(e.value=n))}u.remove()}const d=function(e,t){const n=document.createElement("div");n.className="block-editor-link-control__setting webmention-reaction-setting",n.dataset.url=e||"";const a=document.createElement("label");a.className="webmention-reaction-setting__label",a.setAttribute("for","webmention-reaction-select"),a.textContent=(0,r.__)("Reaction","webmention"),n.appendChild(a);const u=document.createElement("select");return u.id="webmention-reaction-select",u.className="webmention-reaction-setting__select components-select-control__input",i.forEach(e=>{const n=document.createElement("option");n.value=e.value,n.textContent=e.label,n.selected=e.value===t,u.appendChild(n)}),u.addEventListener("change",e=>{!function(e){const t=l();if(!t)return;const{clientId:n,attributes:r}=t,i=s();if(!i||!r.content)return;let a=r.content;if("object"==typeof a&&a.toHTMLString&&(a=a.toHTMLString()),"string"!=typeof a)return;const u=(new DOMParser).parseFromString(`<div>${a}</div>`,"text/html").body.firstChild,d=u.querySelectorAll("a");let f=!1;d.forEach(t=>{const n=t.getAttribute("href");i&&n!==i||(c.forEach(e=>{t.classList.remove(e)}),e&&t.classList.add(e),0===t.classList.length&&t.removeAttribute("class"),f=!0)}),f&&(0,o.dispatch)("core/block-editor").updateBlockAttributes(n,{content:u.innerHTML})}(e.target.value)}),n.appendChild(u),n}(t,n);e.appendChild(d)}n()(()=>{const e=function(e){let t;return function(...n){clearTimeout(t),t=setTimeout(()=>e.apply(this,n),50)}}(u),t=new MutationObserver(()=>{e()});t.observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("beforeunload",()=>{t.disconnect()})})})();